---
import AllergensCard from '@/components/AllergensCard/AllergensCard.astro';
import Container from '@/components/Global/Container.astro';
import MenuList from '@/components/Menu/MenuList';
import Footer from '@/components/sections/Footer/Footer.astro';
import MenuOfTheDay from '@/components/sections/MenuOfTheDay/MenuOfTheDay.astro';
import Layout from '@/layouts/Layout.astro';
import { getAllergens } from '@/lib/getAllergens';
import { getCategories } from '@/lib/getCategories';
import { getDishes } from '@/lib/getDishes';
import { useTranslations } from '@/lib/i18n/useTranslations';

const lang = Astro.currentLocale as "es" | "en" | "de";
const t = useTranslations(lang);

const [categories, dishes, allergens] = await Promise.all([getCategories(lang), getDishes(lang), getAllergens(lang)]);

export async function getStaticPaths() {
	return [
		{ params: { locale: "en" } },
		{ params: { locale: "es" } },
		{ params: { locale: "de" } },
	];
}

export const prerender = true;
---

<Layout title={`${t("nav.menu")} - La cocina de Vero`}>
    <Container className="">
        <MenuOfTheDay server:defer categories={categories} dishes={dishes}/>
        <MenuList client:only lang={lang} dishes={dishes} categories={categories} allergens={allergens}/>
        <AllergensCard allergens={allergens}/>
    </Container>
</Layout>