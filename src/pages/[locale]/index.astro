---
export const prerender = false;
import Layout from "@/layouts/Layout.astro";
import Hero from "@/components/sections/Hero/Hero.astro";
import WhyChooseUs from "@/components/sections/WhyChooseUs/WhyChooseUs.astro";
import OurDishes from "@/components/sections/OurDishes/OurDishes.astro";
import HowItWorks from "@/components/sections/HowItWorks/HowItWorks.astro";
import Testimonials from "@/components/sections/Testimonials/Testimonials.astro";
import CallToAction from "@/components/sections/CallToAction/CallToAction.astro";
import Footer from "@/components/sections/Footer/Footer.astro";
import { getDishesByLang } from "@/lib/getDishesByLang";

export async function getStaticPaths() {
	return [
		{ params: { locale: "en" } },
		{ params: { locale: "de" } },
		{ params: { locale: "es" } },
	];
}

const lang = Astro.currentLocale as "es" | "en" | "de";
const allDishes = await getDishesByLang({limit: 8, conditions: ["image"]});
const popularDishes = {
	es: allDishes.es.filter(dish => !(dish?.image || "").includes("placeholder")).slice(0, 6),
	en: allDishes.en.filter(dish => !(dish?.image || "").includes("placeholder")).slice(0, 6),
	de: allDishes.de.filter(dish => !(dish?.image || "").includes("placeholder")).slice(0, 6),
} as const
---

<Layout title="La cocina de Vero">
	<Hero />
	<WhyChooseUs />
	<OurDishes dishes={popularDishes[lang] ?? popularDishes.es} />
	<HowItWorks />
	<Testimonials />
	<CallToAction />
</Layout>
